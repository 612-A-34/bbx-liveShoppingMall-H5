!function(i) {
    "use strict";
    function a() {}
    function e() {
        e.init.call(this)
    }
    function s(t) {
        return void 0 === t._maxListeners ? e.defaultMaxListeners : t._maxListeners
    }
    function n(t, e, n, r) {
        var o, i;
        if ("function" != typeof n)
            throw new TypeError('"listener" argument must be a function');
        return (o = t._events) ? (o.newListener && (t.emit("newListener", e, n.listener || n),
        o = t._events),
        i = o[e]) : (o = t._events = new a,
        t._eventsCount = 0),
        i ? ("function" == typeof i ? i = o[e] = r ? [n, i] : [i, n] : r ? i.unshift(n) : i.push(n),
        i.warned || (r = s(t)) && 0 < r && i.length > r && (i.warned = !0,
        (r = new Error("Possible EventEmitter memory leak detected. " + i.length + " " + e + " listeners added. Use emitter.setMaxListeners() to increase limit")).name = "MaxListenersExceededWarning",
        r.emitter = t,
        r.type = e,
        r.count = i.length,
        r = r,
        "function" == typeof console.warn ? console.warn(r) : console.log(r))) : (i = o[e] = n,
        ++t._eventsCount),
        t
    }
    function r(t, e, n) {
        var r = !1;
        function o() {
            t.removeListener(e, o),
            r || (r = !0,
            n.apply(t, arguments))
        }
        return o.listener = n,
        o
    }
    function o(t) {
        var e = this._events;
        if (e) {
            t = e[t];
            if ("function" == typeof t)
                return 1;
            if (t)
                return t.length
        }
        return 0
    }
    function u(t, e) {
        for (var n = new Array(e); e--; )
            n[e] = t[e];
        return n
    }
    a.prototype = Object.create(null),
    (e.EventEmitter = e).usingDomains = !1,
    e.prototype.domain = void 0,
    e.prototype._events = void 0,
    e.prototype._maxListeners = void 0,
    e.defaultMaxListeners = 10,
    e.init = function() {
        this.domain = null,
        e.usingDomains && (void 0).active,
        this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = new a,
        this._eventsCount = 0),
        this._maxListeners = this._maxListeners || void 0
    }
    ,
    e.prototype.setMaxListeners = function(t) {
        if ("number" != typeof t || t < 0 || isNaN(t))
            throw new TypeError('"n" argument must be a positive number');
        return this._maxListeners = t,
        this
    }
    ,
    e.prototype.getMaxListeners = function() {
        return s(this)
    }
    ,
    e.prototype.emit = function(t) {
        var e, n, r, o = "error" === t, i = this._events;
        if (i)
            o = o && null == i.error;
        else if (!o)
            return !1;
        if (s = this.domain,
        o) {
            if (o = arguments[1],
            s)
                return (o = o || new Error('Uncaught, unspecified "error" event')).domainEmitter = this,
                o.domain = s,
                o.domainThrown = !1,
                s.emit("error", o),
                !1;
            if (o instanceof Error)
                throw o;
            var s = new Error('Uncaught, unspecified "error" event. (' + o + ")");
            throw s.context = o,
            s
        }
        if (!(e = i[t]))
            return !1;
        var a, c = "function" == typeof e;
        switch (a = arguments.length) {
        case 1:
            !function(t, e, n) {
                if (e)
                    t.call(n);
                else
                    for (var r = t.length, o = u(t, r), i = 0; i < r; ++i)
                        o[i].call(n)
            }(e, c, this);
            break;
        case 2:
            !function(t, e, n, r) {
                if (e)
                    t.call(n, r);
                else
                    for (var o = t.length, i = u(t, o), s = 0; s < o; ++s)
                        i[s].call(n, r)
            }(e, c, this, arguments[1]);
            break;
        case 3:
            !function(t, e, n, r, o) {
                if (e)
                    t.call(n, r, o);
                else
                    for (var i = t.length, s = u(t, i), a = 0; a < i; ++a)
                        s[a].call(n, r, o)
            }(e, c, this, arguments[1], arguments[2]);
            break;
        case 4:
            !function(t, e, n, r, o, i) {
                if (e)
                    t.call(n, r, o, i);
                else
                    for (var s = t.length, a = u(t, s), c = 0; c < s; ++c)
                        a[c].call(n, r, o, i)
            }(e, c, this, arguments[1], arguments[2], arguments[3]);
            break;
        default:
            for (n = new Array(a - 1),
            r = 1; r < a; r++)
                n[r - 1] = arguments[r];
            !function(t, e, n, r) {
                if (e)
                    t.apply(n, r);
                else
                    for (var o = t.length, i = u(t, o), s = 0; s < o; ++s)
                        i[s].apply(n, r)
            }(e, c, this, n)
        }
        return !0
    }
    ,
    e.prototype.addListener = function(t, e) {
        return n(this, t, e, !1)
    }
    ,
    e.prototype.on = e.prototype.addListener,
    e.prototype.prependListener = function(t, e) {
        return n(this, t, e, !0)
    }
    ,
    e.prototype.once = function(t, e) {
        if ("function" != typeof e)
            throw new TypeError('"listener" argument must be a function');
        return this.on(t, r(this, t, e)),
        this
    }
    ,
    e.prototype.prependOnceListener = function(t, e) {
        if ("function" != typeof e)
            throw new TypeError('"listener" argument must be a function');
        return this.prependListener(t, r(this, t, e)),
        this
    }
    ,
    e.prototype.removeListener = function(t, e) {
        var n, r, o, i, s;
        if ("function" != typeof e)
            throw new TypeError('"listener" argument must be a function');
        if (!(r = this._events))
            return this;
        if (!(n = r[t]))
            return this;
        if (n === e || n.listener && n.listener === e)
            0 == --this._eventsCount ? this._events = new a : (delete r[t],
            r.removeListener && this.emit("removeListener", t, n.listener || e));
        else if ("function" != typeof n) {
            for (o = -1,
            i = n.length; 0 < i--; )
                if (n[i] === e || n[i].listener && n[i].listener === e) {
                    s = n[i].listener,
                    o = i;
                    break
                }
            if (o < 0)
                return this;
            if (1 === n.length) {
                if (n[0] = void 0,
                0 == --this._eventsCount)
                    return this._events = new a,
                    this;
                delete r[t]
            } else
                !function(t, e) {
                    for (var n = e, r = n + 1, o = t.length; r < o; n += 1,
                    r += 1)
                        t[n] = t[r];
                    t.pop()
                }(n, o);
            r.removeListener && this.emit("removeListener", t, s || e)
        }
        return this
    }
    ,
    e.prototype.removeAllListeners = function(t) {
        var e, n = this._events;
        if (!n)
            return this;
        if (!n.removeListener)
            return 0 === arguments.length ? (this._events = new a,
            this._eventsCount = 0) : n[t] && (0 == --this._eventsCount ? this._events = new a : delete n[t]),
            this;
        if (0 === arguments.length) {
            for (var r, o = Object.keys(n), i = 0; i < o.length; ++i)
                "removeListener" !== (r = o[i]) && this.removeAllListeners(r);
            return this.removeAllListeners("removeListener"),
            this._events = new a,
            this._eventsCount = 0,
            this
        }
        if ("function" == typeof (e = n[t]))
            this.removeListener(t, e);
        else if (e)
            for (; this.removeListener(t, e[e.length - 1]),
            e[0]; )
                ;
        return this
    }
    ,
    e.prototype.listeners = function(t) {
        var e = this._events
          , n = e && (n = e[t]) ? "function" == typeof n ? [n.listener || n] : function(t) {
            for (var e = new Array(t.length), n = 0; n < e.length; ++n)
                e[n] = t[n].listener || t[n];
            return e
        }(n) : [];
        return n
    }
    ,
    e.listenerCount = function(t, e) {
        return "function" == typeof t.listenerCount ? t.listenerCount(e) : o.call(t, e)
    }
    ,
    e.prototype.listenerCount = o,
    e.prototype.eventNames = function() {
        return 0 < this._eventsCount ? Reflect.ownKeys(this._events) : []
    }
    ;
    var c = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {};
    function t(t) {
        var e = {
            exports: {}
        };
        return t(e, e.exports),
        e.exports
    }
    var h, f, l, d, p, g = t(function(t) {
        !function(n) {
            function c(t, e, n) {
                return e <= t && t <= n
            }
            function s(t) {
                if (void 0 === t)
                    return {};
                if (t === Object(t))
                    return t;
                throw TypeError("Could not convert argument to dictionary")
            }
            function a(t) {
                this.tokens = [].slice.call(t),
                this.tokens.reverse()
            }
            a.prototype = {
                endOfStream: function() {
                    return !this.tokens.length
                },
                read: function() {
                    return this.tokens.length ? this.tokens.pop() : -1
                },
                prepend: function(t) {
                    if (Array.isArray(t))
                        for (var e = t; e.length; )
                            this.tokens.push(e.pop());
                    else
                        this.tokens.push(t)
                },
                push: function(t) {
                    if (Array.isArray(t))
                        for (var e = t; e.length; )
                            this.tokens.unshift(e.shift());
                    else
                        this.tokens.unshift(t)
                }
            };
            function u(t, e) {
                if (t)
                    throw TypeError("Decoder error");
                return e || 65533
            }
            function r(t) {
                return t = String(t).trim().toLowerCase(),
                Object.prototype.hasOwnProperty.call(o, t) ? o[t] : null
            }
            var o = {};
            [{
                encodings: [{
                    labels: ["unicode-1-1-utf-8", "utf-8", "utf8"],
                    name: "UTF-8"
                }],
                heading: "The Encoding"
            }].forEach(function(t) {
                t.encodings.forEach(function(e) {
                    e.labels.forEach(function(t) {
                        o[t] = e
                    })
                })
            });
            var h = {}
              , f = {}
              , i = "utf-8";
            function l(t, e) {
                if (!(this instanceof l))
                    throw TypeError("Called as a function. Did you forget 'new'?");
                t = void 0 !== t ? String(t) : i,
                e = s(e),
                this._encoding = null,
                this._decoder = null,
                this._ignoreBOM = !1,
                this._BOMseen = !1,
                this._error_mode = "replacement",
                this._do_not_flush = !1;
                var n = r(t);
                if (null === n || "replacement" === n.name)
                    throw RangeError("Unknown encoding: " + t);
                if (!f[n.name])
                    throw Error("Decoder not present. Did you forget to include encoding-indexes.js?");
                t = this;
                return t._encoding = n,
                Boolean(e.fatal) && (t._error_mode = "fatal"),
                Boolean(e.ignoreBOM) && (t._ignoreBOM = !0),
                Object.defineProperty || (this.encoding = t._encoding.name.toLowerCase(),
                this.fatal = "fatal" === t._error_mode,
                this.ignoreBOM = t._ignoreBOM),
                t
            }
            function d(t, e) {
                if (!(this instanceof d))
                    throw TypeError("Called as a function. Did you forget 'new'?");
                e = s(e),
                this._encoding = null,
                this._encoder = null,
                this._do_not_flush = !1,
                this._fatal = Boolean(e.fatal) ? "fatal" : "replacement";
                if (Boolean(e.NONSTANDARD_allowLegacyEncoding)) {
                    e = r(t = void 0 !== t ? String(t) : i);
                    if (null === e || "replacement" === e.name)
                        throw RangeError("Unknown encoding: " + t);
                    if (!h[e.name])
                        throw Error("Encoder not present. Did you forget to include encoding-indexes.js?");
                    this._encoding = e
                } else
                    this._encoding = r("utf-8"),
                    void 0 !== t && "console"in n && console.warn("TextEncoder constructor called with encoding label, which is ignored.");
                return Object.defineProperty || (this.encoding = this._encoding.name.toLowerCase()),
                this
            }
            function e(t) {
                var n = t.fatal
                  , r = 0
                  , o = 0
                  , i = 0
                  , s = 128
                  , a = 191;
                this.handler = function(t, e) {
                    if (-1 === e && 0 !== i)
                        return i = 0,
                        u(n);
                    if (-1 === e)
                        return -1;
                    if (0 === i) {
                        if (c(e, 0, 127))
                            return e;
                        if (c(e, 194, 223))
                            i = 1,
                            r = 31 & e;
                        else if (c(e, 224, 239))
                            224 === e && (s = 160),
                            237 === e && (a = 159),
                            i = 2,
                            r = 15 & e;
                        else {
                            if (!c(e, 240, 244))
                                return u(n);
                            240 === e && (s = 144),
                            244 === e && (a = 143),
                            i = 3,
                            r = 7 & e
                        }
                        return null
                    }
                    if (!c(e, s, a))
                        return r = i = o = 0,
                        s = 128,
                        a = 191,
                        t.prepend(e),
                        u(n);
                    if (s = 128,
                    a = 191,
                    r = r << 6 | 63 & e,
                    (o += 1) !== i)
                        return null;
                    e = r;
                    return r = i = o = 0,
                    e
                }
            }
            function p(t) {
                t.fatal,
                this.handler = function(t, e) {
                    if (-1 === e)
                        return -1;
                    if (c(e, 0, 127))
                        return e;
                    var n, r;
                    c(e, 128, 2047) ? (n = 1,
                    r = 192) : c(e, 2048, 65535) ? (n = 2,
                    r = 224) : c(e, 65536, 1114111) && (n = 3,
                    r = 240);
                    for (var o = [(e >> 6 * n) + r]; 0 < n; )
                        o.push(128 | 63 & e >> 6 * (n - 1)),
                        --n;
                    return o
                }
            }
            Object.defineProperty && (Object.defineProperty(l.prototype, "encoding", {
                get: function() {
                    return this._encoding.name.toLowerCase()
                }
            }),
            Object.defineProperty(l.prototype, "fatal", {
                get: function() {
                    return "fatal" === this._error_mode
                }
            }),
            Object.defineProperty(l.prototype, "ignoreBOM", {
                get: function() {
                    return this._ignoreBOM
                }
            })),
            l.prototype.decode = function(t, e) {
                t = "object" == typeof t && t instanceof ArrayBuffer ? new Uint8Array(t) : "object" == typeof t && "buffer"in t && t.buffer instanceof ArrayBuffer ? new Uint8Array(t.buffer,t.byteOffset,t.byteLength) : new Uint8Array(0);
                e = s(e),
                this._do_not_flush || (this._decoder = f[this._encoding.name]({
                    fatal: "fatal" === this._error_mode
                }),
                this._BOMseen = !1),
                this._do_not_flush = Boolean(e.stream);
                for (var n, r = new a(t), o = []; ; ) {
                    var i = r.read();
                    if (-1 === i)
                        break;
                    if (-1 === (n = this._decoder.handler(r, i)))
                        break;
                    null !== n && (Array.isArray(n) ? o.push.apply(o, n) : o.push(n))
                }
                if (!this._do_not_flush) {
                    for (; -1 !== (n = this._decoder.handler(r, r.read())) && (null !== n && (Array.isArray(n) ? o.push.apply(o, n) : o.push(n)),
                    !r.endOfStream()); )
                        ;
                    this._decoder = null
                }
                return function(t) {
                    var e, n;
                    return e = ["UTF-8", "UTF-16LE", "UTF-16BE"],
                    n = this._encoding.name,
                    -1 === e.indexOf(n) || this._ignoreBOM || this._BOMseen || (0 < t.length && 65279 === t[0] ? (this._BOMseen = !0,
                    t.shift()) : 0 < t.length && (this._BOMseen = !0)),
                    function(t) {
                        for (var e = "", n = 0; n < t.length; ++n) {
                            var r = t[n];
                            r <= 65535 ? e += String.fromCharCode(r) : (r -= 65536,
                            e += String.fromCharCode(55296 + (r >> 10), 56320 + (1023 & r)))
                        }
                        return e
                    }(t)
                }
                .call(this, o)
            }
            ,
            Object.defineProperty && Object.defineProperty(d.prototype, "encoding", {
                get: function() {
                    return this._encoding.name.toLowerCase()
                }
            }),
            d.prototype.encode = function(t, e) {
                t = t ? String(t) : "",
                e = s(e),
                this._do_not_flush || (this._encoder = h[this._encoding.name]({
                    fatal: "fatal" === this._fatal
                })),
                this._do_not_flush = Boolean(e.stream);
                for (var n, r = new a(function(t) {
                    for (var e = String(t), n = e.length, r = 0, o = []; r < n; ) {
                        var i, s = e.charCodeAt(r);
                        s < 55296 || 57343 < s ? o.push(s) : 56320 <= s && s <= 57343 ? o.push(65533) : 55296 <= s && s <= 56319 && (r !== n - 1 && 56320 <= (i = t.charCodeAt(r + 1)) && i <= 57343 ? (o.push(65536 + ((1023 & s) << 10) + (1023 & i)),
                        r += 1) : o.push(65533)),
                        r += 1
                    }
                    return o
                }(t)), o = []; ; ) {
                    var i = r.read();
                    if (-1 === i)
                        break;
                    if (-1 === (n = this._encoder.handler(r, i)))
                        break;
                    Array.isArray(n) ? o.push.apply(o, n) : o.push(n)
                }
                if (!this._do_not_flush) {
                    for (; -1 !== (n = this._encoder.handler(r, r.read())); )
                        Array.isArray(n) ? o.push.apply(o, n) : o.push(n);
                    this._encoder = null
                }
                return new Uint8Array(o)
            }
            ,
            h["UTF-8"] = function(t) {
                return new p(t)
            }
            ,
            f["UTF-8"] = function(t) {
                return new e(t)
            }
            ,
            n.TextEncoder || (n.TextEncoder = d),
            n.TextDecoder || (n.TextDecoder = l),
            t.exports && (t.exports = {
                TextEncoder: n.TextEncoder,
                TextDecoder: n.TextDecoder
            })
        }(c || {})
    }), v = {
        TextEncoder: g.TextEncoder,
        TextDecoder: g.TextDecoder
    }, y = t(function(t, s) {
        function f(t, e, n) {
            t.byteLength;
            for (var r = 0, o = n.length; r < o; r++) {
                var i = n.charCodeAt(r);
                if (i < 128)
                    t.setUint8(e++, i >>> 0 & 127 | 0);
                else if (i < 2048)
                    t.setUint8(e++, i >>> 6 & 31 | 192),
                    t.setUint8(e++, i >>> 0 & 63 | 128);
                else if (i < 65536)
                    t.setUint8(e++, i >>> 12 & 15 | 224),
                    t.setUint8(e++, i >>> 6 & 63 | 128),
                    t.setUint8(e++, i >>> 0 & 63 | 128);
                else {
                    if (!(i < 1114112))
                        throw new Error("bad codepoint " + i);
                    t.setUint8(e++, i >>> 18 & 7 | 240),
                    t.setUint8(e++, i >>> 12 & 63 | 128),
                    t.setUint8(e++, i >>> 6 & 63 | 128),
                    t.setUint8(e++, i >>> 0 & 63 | 128)
                }
            }
        }
        function n(e, n, r) {
            var t, o = "", i = "undefined" != typeof window && window.navigator.userAgent.match(/Chrome\/(\S+)/), s = 0;
            i && i[1] && (s = parseInt(i[1]),
            isNaN(s) && (s = 0));
            try {
                t = new ("undefined" != typeof TextDecoder && 41 < s ? TextDecoder : v.TextDecoder)("utf-8",{
                    fatal: !0
                });
                var a = e.buffer.slice(n, n + r)
                  , o = t.decode(a)
            } catch (t) {
                o = e.buffer.slice(n, n + r)
            }
            return o
        }
        function l(t) {
            for (var e = 0, n = 0, r = t.length; n < r; n++) {
                var o = t.charCodeAt(n);
                if (o < 128)
                    e += 1;
                else if (o < 2048)
                    e += 2;
                else if (o < 65536)
                    e += 3;
                else {
                    if (!(o < 1114112))
                        throw new Error("bad codepoint " + o);
                    e += 4
                }
            }
            return e
        }
        function r(t, e, n) {
            this.offset = e || 0,
            this.view = t,
            this.bytes = n
        }
        s.inspect = function(t) {
            if (void 0 === t)
                return "undefined";
            var e, n;
            t instanceof ArrayBuffer ? (n = "ArrayBuffer",
            e = new DataView(t)) : t instanceof DataView && (n = "DataView",
            e = t);
            if (!e)
                return JSON.stringify(t);
            for (var r = [], o = 0; o < t.byteLength; o++) {
                if (20 < o) {
                    r.push("...");
                    break
                }
                var i = e.getUint8(o).toString(16);
                1 === i.length && (i = "0" + i),
                r.push(i)
            }
            return "<" + n + " " + r.join(" ") + ">"
        }
        ,
        s.utf8Write = f,
        s.utf8Read = n,
        s.utf8ByteCount = l,
        s.encode = function(t) {
            var e = new ArrayBuffer(function t(e) {
                var n = typeof e;
                if ("string" == n) {
                    var r = l(e);
                    if (r < 32)
                        return 1 + r;
                    if (r < 65536)
                        return 3 + r;
                    if (r < 4294967296)
                        return 5 + r
                }
                if (e instanceof ArrayBuffer) {
                    var r = e.byteLength;
                    if (r < 65536)
                        return 3 + r;
                    if (r < 4294967296)
                        return 5 + r
                }
                if ("number" == n) {
                    if (e << 0 !== e)
                        return 9;
                    if (0 <= e) {
                        if (e < 128)
                            return 1;
                        if (e < 256)
                            return 2;
                        if (e < 65536)
                            return 3;
                        if (e < 4294967296)
                            return 5;
                        if (e < 0x10000000000000000)
                            return 9;
                        throw new Error("Number too big 0x" + e.toString(16))
                    }
                    if (-32 <= e)
                        return 1;
                    if (-128 <= e)
                        return 2;
                    if (-32768 <= e)
                        return 3;
                    if (-2147483648 <= e)
                        return 5;
                    if (-0x8000000000000000 <= e)
                        return 9;
                    throw new Error("Number too small -0x" + e.toString(16).substr(1))
                }
                if ("boolean" == n || "undefined" == n || null === e)
                    return 1;
                if ("object" == n) {
                    var o = 0;
                    if (Array.isArray(e)) {
                        r = e.length;
                        for (var i = 0; i < r; i++)
                            o += t(e[i])
                    } else {
                        var s = Object.keys(e);
                        r = s.length;
                        for (var i = 0; i < r; i++) {
                            var a = s[i];
                            o += t(a) + t(e[a])
                        }
                    }
                    if (r < 16)
                        return 1 + o;
                    if (r < 65536)
                        return 3 + o;
                    if (r < 4294967296)
                        return 5 + o;
                    throw new Error("Array or object too long 0x" + r.toString(16))
                }
                throw new Error("Unknown type " + n)
            }(t));
            return function t(e, n, r) {
                var o = typeof e;
                if ("string" == o) {
                    var i = l(e);
                    if (i < 32)
                        return n.setUint8(r, 160 | i),
                        f(n, r + 1, e),
                        1 + i;
                    if (i < 65536)
                        return n.setUint8(r, 218),
                        n.setUint16(r + 1, i),
                        f(n, r + 3, e),
                        3 + i;
                    if (i < 4294967296)
                        return n.setUint8(r, 219),
                        n.setUint32(r + 1, i),
                        f(n, r + 5, e),
                        5 + i
                }
                if (e instanceof ArrayBuffer) {
                    var i = e.byteLength;
                    if (i < 65536)
                        return n.setUint8(r, 216),
                        n.setUint16(r + 1, i),
                        new Uint8Array(n.buffer).set(new Uint8Array(e), r + 3),
                        3 + i;
                    if (i < 4294967296)
                        return n.setUint8(r, 217),
                        n.setUint32(r + 1, i),
                        new Uint8Array(n.buffer).set(new Uint8Array(e), r + 5),
                        5 + i
                }
                if ("number" == o) {
                    if (e << 0 !== e)
                        return n.setUint8(r, 203),
                        n.setFloat64(r + 1, e),
                        9;
                    if (0 <= e) {
                        if (e < 128)
                            return n.setUint8(r, e),
                            1;
                        if (e < 256)
                            return n.setUint8(r, 204),
                            n.setUint8(r + 1, e),
                            2;
                        if (e < 65536)
                            return n.setUint8(r, 205),
                            n.setUint16(r + 1, e),
                            3;
                        if (e < 4294967296)
                            return n.setUint8(r, 206),
                            n.setUint32(r + 1, e),
                            5;
                        throw new Error("Number too big 0x" + e.toString(16))
                    }
                    if (-32 <= e)
                        return n.setInt8(r, e),
                        1;
                    if (-128 <= e)
                        return n.setUint8(r, 208),
                        n.setInt8(r + 1, e),
                        2;
                    if (-32768 <= e)
                        return n.setUint8(r, 209),
                        n.setInt16(r + 1, e),
                        3;
                    if (-2147483648 <= e)
                        return n.setUint8(r, 210),
                        n.setInt32(r + 1, e),
                        5;
                    throw new Error("Number too small -0x" + (-e).toString(16).substr(1))
                }
                if ("undefined" == o)
                    return n.setUint8(r, 196),
                    1;
                if (null === e)
                    return n.setUint8(r, 192),
                    1;
                if ("boolean" == o)
                    return n.setUint8(r, e ? 195 : 194),
                    1;
                if ("object" == o) {
                    var s, a = 0, c = Array.isArray(e);
                    if ((i = c ? e.length : (s = Object.keys(e)).length) < 16 ? (n.setUint8(r, i | (c ? 144 : 128)),
                    a = 1) : i < 65536 ? (n.setUint8(r, c ? 220 : 222),
                    n.setUint16(r + 1, i),
                    a = 3) : i < 4294967296 && (n.setUint8(r, c ? 221 : 223),
                    n.setUint32(r + 1, i),
                    a = 5),
                    c)
                        for (var u = 0; u < i; u++)
                            a += t(e[u], n, r + a);
                    else
                        for (var u = 0; u < i; u++) {
                            var h = s[u];
                            a += t(h, n, r + a),
                            a += t(e[h], n, r + a)
                        }
                    return a
                }
                throw new Error("Unknown type " + o)
            }(t, new DataView(e), 0),
            e
        }
        ,
        s.decode = function(t) {
            var e = t.buffer
              , n = new r(new DataView(e),0,t)
              , t = n.parse();
            if (n.offset !== e.byteLength)
                throw new Error(e.byteLength - n.offset + " trailing bytes");
            return t
        }
        ,
        r.prototype.map = function(t) {
            for (var e = {}, n = 0; n < t; n++)
                e[this.parse()] = this.parse();
            return e
        }
        ,
        r.prototype.buf = function(t) {
            var e = new ArrayBuffer(t);
            return new Uint8Array(e).set(new Uint8Array(this.view.buffer,this.offset,t), 0),
            this.offset += t,
            e
        }
        ,
        r.prototype.raw = function(t) {
            var e = n(this.view, this.offset, t);
            return this.offset += t,
            e
        }
        ,
        r.prototype.array = function(t) {
            for (var e = new Array(t), n = 0; n < t; n++)
                e[n] = this.parse();
            return e
        }
        ,
        r.prototype.parse = function() {
            var t, e, n = this.view.getUint8(this.offset);
            if (160 == (224 & n))
                return e = 31 & n,
                this.offset++,
                this.raw(e);
            if (128 == (240 & n))
                return e = 15 & n,
                this.offset++,
                this.map(e);
            if (144 == (240 & n))
                return e = 15 & n,
                this.offset++,
                this.array(e);
            if (0 == (128 & n))
                return this.offset++,
                n;
            if (224 == (224 & n))
                return t = this.view.getInt8(this.offset),
                this.offset++,
                t;
            switch (n) {
            case 218:
                return e = this.view.getUint16(this.offset + 1),
                this.offset += 3,
                this.raw(e);
            case 219:
                return e = this.view.getUint32(this.offset + 1),
                this.offset += 5,
                this.raw(e);
            case 192:
                return this.offset++,
                null;
            case 194:
                return this.offset++,
                !1;
            case 195:
                return this.offset++,
                !0;
            case 196:
                return void this.offset++;
            case 204:
                return t = this.view.getUint8(this.offset + 1),
                this.offset += 2,
                t;
            case 205:
                return t = this.view.getUint16(this.offset + 1),
                this.offset += 3,
                t;
            case 206:
                return t = this.view.getUint32(this.offset + 1),
                this.offset += 5,
                t;
            case 208:
                return t = this.view.getInt8(this.offset + 1),
                this.offset += 2,
                t;
            case 209:
                return t = this.view.getInt16(this.offset + 1),
                this.offset += 3,
                t;
            case 210:
                return t = this.view.getInt32(this.offset + 1),
                this.offset += 5,
                t;
            case 222:
                return e = this.view.getUint16(this.offset + 1),
                this.offset += 3,
                this.map(e);
            case 223:
                return e = this.view.getUint32(this.offset + 1),
                this.offset += 5,
                this.map(e);
            case 220:
                return e = this.view.getUint16(this.offset + 1),
                this.offset += 3,
                this.array(e);
            case 221:
                return e = this.view.getUint32(this.offset + 1),
                this.offset += 5,
                this.array(e);
            case 216:
                return e = this.view.getUint16(this.offset + 1),
                this.offset += 3,
                this.buf(e);
            case 217:
                return e = this.view.getUint32(this.offset + 1),
                this.offset += 5,
                this.buf(e);
            case 202:
                return t = this.view.getFloat32(this.offset + 1),
                this.offset += 5,
                t;
            case 203:
                return t = this.view.getFloat64(this.offset + 1),
                this.offset += 9,
                t;
            case 207:
                var r = this.bytes;
                return this.offset++,
                4294967296 * (16777216 * r[this.offset++] + (r[this.offset++] << 16) + (r[this.offset++] << 8) + r[this.offset++]) + 16777216 * r[this.offset++] + (r[this.offset++] << 16) + (r[this.offset++] << 8) + r[this.offset++]
            }
            throw new Error("Unknown type 0x" + n.toString(16))
        }
        ;
        function e(t) {
            var e = t.length
              , n = e % 4
              , t = (0 < e ? o[t.charAt(0)] << 18 : 0) | (1 < e ? o[t.charAt(1)] << 12 : 0) | (2 < e ? o[t.charAt(2)] << 6 : 0) | (3 < e ? o[t.charAt(3)] : 0);
            return (t = [i(t >>> 16), i(t >>> 8 & 255), i(255 & t)]).length -= [0, 0, 2, 1][n],
            t.join("")
        }
        var o = function(t) {
            for (var e = {}, n = 0, r = t.length; n < r; n++)
                e[t.charAt(n)] = n;
            return e
        }("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")
          , i = String.fromCharCode
          , a = "undefined" != typeof window && window.atob ? function(t) {
            return window.atob(t)
        }
        : function(t) {
            return t.replace(/[\s\S]{1,4}/g, e)
        }
        ;
        s.decodeFromB64 = function(t) {
            for (var e = a(t), n = e.length, r = new Uint8Array(n), o = 0; o < n; o++) {
                var i = e.charCodeAt(o);
                r[o] = i
            }
            return s.decode(r)
        }
    }), m = 0, _ = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"], E = window.WebSocket, w = function(t, e) {
        function n() {
            this.constructor = t
        }
        h(t, e),
        t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype,
        new n)
    }, C = function() {
        return (C = Object.assign || function(t) {
            for (var e, n = 1, r = arguments.length; n < r; n++)
                for (var o in e = arguments[n])
                    Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]);
            return t
        }
        ).apply(this, arguments)
    }, O = {
        wv: "im:0,au:0,sy:0"
    }, S = {
        canSendBeforeAuth: !(h = function(t, e) {
            return (h = Object.setPrototypeOf || {
                __proto__: []
            }instanceof Array && function(t, e) {
                t.__proto__ = e
            }
            || function(t, e) {
                for (var n in e)
                    e.hasOwnProperty(n) && (t[n] = e[n])
            }
            )(t, e)
        }
        ),
        timeout: 6e4
    };
    (at = f = f || {})[at.LWP_AUTH_NOT_READY = 510] = "LWP_AUTH_NOT_READY",
    at[at.CONNECT_UNAVAILABLE = 511] = "CONNECT_UNAVAILABLE",
    at[at.LOCAL_TIMEOUT = 508] = "LOCAL_TIMEOUT",
    (G = l = l || {})[G.NOT_AUTHED = 401] = "NOT_AUTHED",
    G[G.HANDLER_NOT_FOUND = 400] = "HANDLER_NOT_FOUND",
    G[G.TIMEOUT = 408] = "TIMEOUT",
    G[G.BIZ_ERR = 500] = "BIZ_ERR",
    (q = d = d || {})[q.INITED = 0] = "INITED",
    q[q.CONNECTING = 1] = "CONNECTING",
    q[q.SILENT_CONNECTING = 2] = "SILENT_CONNECTING",
    q[q.OPENED = 3] = "OPENED",
    q[q.CLOSING = 4] = "CLOSING",
    q[q.CLOSED = 5] = "CLOSED",
    (g = p = p || {})[g.INITED = 0] = "INITED",
    g[g.REGED = 1] = "REGED",
    g[g.REG_FAILED = 2] = "REG_FAILED",
    g[g.SUBSCRIBING = 3] = "SUBSCRIBING",
    g[g.SUBSCRIBED = 4] = "SUBSCRIBED",
    g[g.REFRESH_TOKEN = 5] = "REFRESH_TOKEN",
    g[g.SUBSCRIBE_FAILED = 6] = "SUBSCRIBE_FAILED";
    var N, b, T = (N = e.EventEmitter,
    w(I, N),
    I.prototype.connect = function() {
        this.setConnectState(d.INITED),
        this.setAuthState(p.INITED),
        this.tryConnectTime = 0,
        this._connect()
    }
    ,
    I.prototype.setCloundPaasSign = function(t) {
        this.lwpDefaultHeaders.sign = t
    }
    ,
    I.prototype.setAuthInfo = function(t) {
        return this.authState === p.SUBSCRIBE_FAILED ? (this.authInfo = t,
        this.auth()) : Promise.reject("auth state is not subscribe_failed when set auth info")
    }
    ,
    I.prototype.getPaasDomain = function() {
        return this.paasDomain
    }
    ,
    I.prototype.getAuthInfo = function() {
        return this.authInfo
    }
    ,
    I.prototype.getClientOption = function() {
        return Object.assign({}, this.option)
    }
    ,
    I.prototype.clearAuthInfo = function() {
        !(this.authInfo = void 0) !== this.option.disableWsAuthConnect ? this._connect() : this.pingTimer && clearTimeout(this.pingTimer),
        this.setAuthState(p.INITED)
    }
    ,
    I.prototype.initDevicePush = function() {
        return this.sendMsg("/reg/init", {}, null, {
            canSendBeforeAuth: !0
        })
    }
    ,
    I.prototype.registerPushHandler = function(t, e) {
        if (this.pushHandlerCache[t])
            throw new Error("you have register this topic before: " + t);
        this.pushHandlerCache[t] = e
    }
    ,
    I.prototype.removePushHandler = function(t) {
        delete this.pushHandlerCache[t]
    }
    ,
    I.prototype.close = function() {
        this.setConnectState(d.CLOSED),
        this.wsInstance && this.wsInstance.close()
    }
    ,
    I.prototype.sendMsg = function(t, e, n, r) {
        var o = this;
        void 0 === e && (e = {}),
        void 0 === r && (r = S);
        var i, s, e = Object.assign({}, e, {
            mid: (i = Math.floor(Math.random() * Math.pow(2, 16)),
            s = m++,
            e = "",
            e += _[i >> 12 & 15],
            e += _[i >> 8 & 15],
            e += _[i >> 4 & 15],
            e += _[15 & i],
            e += _[s >> 12 & 15],
            e += _[s >> 8 & 15],
            e += _[s >> 4 & 15],
            (e += _[15 & s]) + " 0")
        }), a = this.getMsgId(e.mid), c = !1;
        !0 !== r.canSendBeforeReg && (!0 !== r.canSendBeforeAuth || this.authState !== p.REGED && this.authState !== p.SUBSCRIBING && this.authState !== p.SUBSCRIBE_FAILED && this.authState !== p.SUBSCRIBED) && this.authState !== p.SUBSCRIBED || (c = !0);
        var u = {
            lwp: t,
            headers: e,
            body: n,
            option: r
        };
        return new Promise(function(e, n) {
            if (c)
                if (o.connectState === d.OPENED) {
                    try {
                        o.sendRawMsg({
                            lwp: u.lwp,
                            headers: u.headers,
                            body: u.body
                        }),
                        o.pendingMsgs[a] = {
                            request: u,
                            resolve: e,
                            reject: n
                        }
                    } catch (t) {
                        o.waitingReconnectMsgs[a] = {
                            request: u,
                            resolve: e,
                            reject: n
                        }
                    }
                    o.setupTimeoutTimer(a, u.option.timeout)
                } else
                    o.connectState === d.SILENT_CONNECTING ? (o.waitingReconnectMsgs[a] = {
                        request: u,
                        resolve: e,
                        reject: n
                    },
                    o.setupTimeoutTimer(a, u.option.timeout)) : n({
                        code: f.CONNECT_UNAVAILABLE,
                        body: {
                            reason: "connect is unavailable"
                        }
                    });
            else
                n({
                    code: f.LWP_AUTH_NOT_READY,
                    body: {
                        reason: "lwp auth not ready"
                    }
                })
        }
        )
    }
    ,
    I.prototype.sendRawMsg = function(t) {
        if (!this.wsInstance)
            throw new Error("wsInstance is not exist");
        this.wsInstance.send(JSON.stringify({
            code: t.code,
            lwp: t.lwp,
            headers: t.headers,
            body: t.body
        }))
    }
    ,
    I.prototype.flushWaitingMsgs = function() {
        var a = this
          , t = Object.keys(this.waitingReconnectMsgs);
        t.length && t.forEach(function(t) {
            var e, n, r, o, i, s = a.waitingReconnectMsgs[t];
            s && (i = s.request,
            e = s.resolve,
            n = s.reject,
            r = i.lwp,
            o = i.headers,
            s = i.body,
            i = i.option,
            delete a.waitingReconnectMsgs[t],
            a.sendMsg(r, o, s, i).then(e, n))
        })
    }
    ,
    I.prototype.rejectPendingMsgs = function() {
        var n = this
          , t = Object.keys(this.pendingMsgs);
        t.length && t.forEach(function(t) {
            var e = n.pendingMsgs[t];
            e && (e.reject({
                code: f.CONNECT_UNAVAILABLE,
                body: {
                    reason: "connect is unavailable"
                }
            }),
            (e = n.msgTimerCache[t]) && clearTimeout(e),
            delete n.msgTimerCache[t],
            delete n.pendingMsgs[t])
        })
    }
    ,
    I.prototype.setupTimeoutTimer = function(n, t) {
        var r = this;
        36e5 < (t = (t = t || S.timeout) < 0 ? S.timeout : t) && (t = 36e5);
        var o = {
            code: f.LOCAL_TIMEOUT,
            body: {
                reason: "timeout by local"
            }
        }
          , t = setTimeout(function() {
            var t = r.pendingMsgs[n]
              , e = r.waitingReconnectMsgs[n];
            t && t.reject(o),
            e && e.reject(o),
            delete r.pendingMsgs[n],
            delete r.waitingReconnectMsgs[n],
            delete r.msgTimerCache[n]
        }, t);
        this.msgTimerCache[n] = t
    }
    ,
    I.prototype._connect = function() {
        var e = this;
        this.connectState !== d.CLOSED && this.connectState !== d.CLOSING && !0 !== this.isConnecting && (this.isConnecting = !0,
        this.tryConnectTime < 5 ? this.setConnectState(d.SILENT_CONNECTING) : this.setConnectState(d.CONNECTING),
        this.openWs().then(function(t) {
            e.isConnecting = !1,
            e.wsInstance = t,
            e.bindWSEvent(t),
            e.setConnectState(d.OPENED),
            e.reg(),
            e.tryConnectTimer && clearTimeout(e.tryConnectTimer)
        }).catch(function(t) {
            e.isConnecting = !1,
            e.localLog.error("lwp client", e.name, "open ws error", t),
            e.tryConnectTime++,
            e.tryConnectTimer && clearTimeout(e.tryConnectTimer),
            e.tryConnectTimer = setTimeout(function() {
                e._connect()
            }, Math.min(100 * Math.pow(2, e.tryConnectTime), 5e3))
        }))
    }
    ,
    I.prototype.reg = function() {
        var e = this
          , t = C({
            "cache-header": "token app-key did ua vhost wv scm_project",
            vhost: "WK",
            ua: this.option.ua,
            "app-key": this.option.appKey,
            did: this.option.deviceId,
            dt: "j"
        }, this.lwpDefaultHeaders);
        this.option.scmProject && (t.scm_project = this.option.scmProject),
        !0 !== this.option.paasProject && void 0 !== t.sign && delete t.sign,
        !0 === this.option.isAssistant && (t.token = this.option.accessToken || "",
        t.subscribe = "false"),
        this.localLog.info("lwpclient", this.name, "start reg"),
        this.sendMsg("/reg", t, null, {
            canSendBeforeReg: !0,
            timeout: 15e3
        }).then(function() {
            e.authState !== p.SUBSCRIBED && e.setAuthState(p.REGED),
            e.localLog.info("lwpclinet", e.name, "reg success"),
            !0 !== e.option.isAssistant ? (!0 !== e.option.paasProject && e.initDevicePush(),
            e.auth().catch(function() {
                !0 !== e.option.paasProject && e.localLog.info("lwpclinet", e.name, "auth fail")
            })) : e.flushWaitingMsgs()
        }).catch(function(t) {
            !0 !== e.option.isAssistant || !t || 400 !== t.code && 401 !== t.code ? e.setAuthState(p.REG_FAILED) : e.setAuthState(p.REGED),
            e.localLog.error("lwpclinet", e.name, "reg fail", JSON.stringify(t), t.stack)
        })
    }
    ,
    I.prototype.auth = function() {
        var e = this;
        if (this.setAuthState(p.SUBSCRIBING),
        this.authInfo) {
            var t = C({
                token: this.authInfo.accessToken,
                sync: "0,0;0;0;",
                "set-ver": "0",
                dt: "j"
            }, this.lwpDefaultHeaders);
            return !0 === this.option.paasProject ? delete t["set-ver"] : void 0 !== t.sign && delete t.sign,
            this.sendMsg("/reg", t, null, {
                canSendBeforeAuth: !0
            }).then(function(t) {
                e.option.paasProject && t && t.headers && t.headers["reg-uid"] && (e.paasDomain = t.headers["reg-uid"].split("@")[1]),
                e.setAuthState(p.SUBSCRIBED),
                e.flushWaitingMsgs()
            }).catch(function(t) {
                return e.setAuthState(p.SUBSCRIBE_FAILED),
                e.flushWaitingMsgs(),
                Promise.reject(t)
            })
        }
        return this.setAuthState(p.SUBSCRIBE_FAILED),
        this.flushWaitingMsgs(),
        Promise.reject("auth info is null")
    }
    ,
    I.prototype.bindWSEvent = function(e) {
        var n = this;
        e.onmessage = function(t) {
            n.receiveMsgEvent(t)
        }
        ,
        e.onclose = function(t) {
            n.wsInstance === e && (!0 !== n.option.disableWsAuthConnect ? n._connect() : n.clearAuthInfo())
        }
        ,
        e.onerror = function(t) {
            n.localLog.error("lwpclient onerror", t)
        }
    }
    ,
    I.prototype.getMsgId = function(t) {
        return t.split(" ")[0]
    }
    ,
    I.prototype.receiveMsgEvent = function(e) {
        var n, t, r, o = this;
        if ("string" == typeof e.data) {
            try {
                t = JSON.parse(e.data)
            } catch (t) {
                return void this.localLog.error("lwpclient: ", this.name + " parse json error :" + e.data)
            }
            if (t.code && t.headers) {
                var i = Object.assign({}, t)
                  , s = (i.headers && i.headers.mid || "").split(" ")[0]
                  , a = this.pendingMsgs[s];
                if (a) {
                    if (102 === i.code)
                        return a.reponseBodyList || (a.reponseBodyList = []),
                        void a.reponseBodyList.push(i.body);
                    200 === i.code ? a.reponseBodyList && a.reponseBodyList.length ? a.resolve(C(C({}, i), {
                        reponseBodyList: a.reponseBodyList
                    })) : a.resolve(i) : a.reject(i);
                    var c = this.msgTimerCache[s];
                    c && clearTimeout(c),
                    delete this.msgTimerCache[s],
                    delete this.pendingMsgs[s]
                }
            } else
                t.lwp && t.headers ? (s = (c = Object.assign({}, t)).lwp,
                n = c.headers.mid,
                t = this.pushHandlerCache[s],
                r = function(t) {
                    var e = Object.assign({}, t.headers || {}, {
                        mid: n
                    });
                    o.sendRawMsg({
                        code: t.code,
                        headers: e,
                        body: t.body
                    })
                }
                ,
                t ? t(c).then(function(t) {
                    r(t)
                }).catch(function(t) {
                    r({
                        code: l.BIZ_ERR,
                        headers: {},
                        body: null
                    })
                }) : r("/s/msg" === s ? {
                    code: 200,
                    headers: {},
                    body: {}
                } : {
                    code: l.HANDLER_NOT_FOUND,
                    headers: {},
                    body: null
                })) : this.localLog.error("receive unexpected msg: " + e.data)
        }
        this.pingTimer && clearTimeout(this.pingTimer),
        this.pingTimer = setTimeout(function() {
            o.ping()
        }, 15e3)
    }
    ,
    I.prototype.ping = function() {
        var e = this;
        this.sendMsg("/!", {}, null, {
            timeout: 1e4,
            canSendBeforeReg: !0
        }).then(function() {}, function(t) {
            e.localLog.info("lwpclient", "ws: " + e.name + "ping  :", t),
            e.authState !== p.INITED && (e.rejectPendingMsgs(),
            e._connect())
        })
    }
    ,
    I.prototype.openWs = function() {
        var i = this;
        return new Promise(function(t, e) {
            var n, r, o = setTimeout(function() {
                e(new Error("timeout"))
            }, 5e3);
            try {
                r = i.option.wsUrl,
                i.option.ua,
                n = new E(r)
            } catch (t) {
                return void e(t)
            }
            n.onopen = function() {
                clearTimeout(o),
                t(n)
            }
            ,
            n.onclose = function(t) {
                clearTimeout(o),
                e(new Error(t.reason))
            }
            ,
            n.onerror = function(t) {
                clearTimeout(o),
                e(new Error(JSON.stringify(t)))
            }
        }
        )
    }
    ,
    I.prototype.setAuthState = function(t) {
        t !== this.authState && (this.authState = t,
        this.emit(I.EventsName.AuthStateChange, t))
    }
    ,
    I.prototype.setConnectState = function(t) {
        t !== this.connectState && (this.connectState = t,
        this.emit(I.EventsName.ConnectStateChange, t))
    }
    ,
    I.EventsName = {
        AuthStateChange: "AuthStateChange",
        ConnectStateChange: "ConnectStateChange"
    },
    I);
    function I(t, e) {
        var n = N.call(this) || this;
        return n.name = t,
        n.option = e,
        n.pendingMsgs = {},
        n.waitingReconnectMsgs = {},
        n.msgTimerCache = {},
        n.authState = p.INITED,
        n.connectState = d.CLOSED,
        n.localLog = e.log,
        n.tryConnectTime = 0,
        n.isConnecting = !1,
        n.pushHandlerCache = {},
        n.lwpDefaultHeaders = e.lwpHeadersConfig || O,
        n.paasDomain = "",
        n
    }
    let L = null;
    const A = ()=>{
        if (!L)
            throw new Error("must connect after init");
        L.connect()
    }
    ;
    const R = new class {
        constructor(t) {
            this.handlePush = t=>{
                let e = Promise.resolve();
                if (t.body && t.body[1] && t.body[1][6]) {
                    const n = t.body[1][6];
                    Array.isArray(n) && 0 < n.length && (e = n.reduce((t,r)=>t.then(()=>{
                        var t = r[1]
                          , e = r[2];
                        const n = this.syncHandlers[t + ""];
                        if (n)
                            return n(y.decodeFromB64(e))
                    }
                    ), e))
                }
                return e.then(()=>({
                    code: 200,
                    headers: {},
                    body: null
                }))
            }
            ,
            this.topicName = t,
            this.syncHandlers = {}
        }
        registerSyncItemHandler(t, e) {
            this.syncHandlers[t + ""] = e
        }
        clearSyncItemHandler(t) {
            this.syncHandlers[t + ""] = void 0
        }
    }
    ("/s/syncDev");
    let U = !1;
    const P = t=>{
        (()=>{
            const t = L;
            if (!t)
                throw new Error("initDeviceSync must after initLWPClient");
            !1 === U && (t.registerPushHandler(R.topicName, R.handlePush),
            U = !0)
        }
        )();
        const e = L;
        return e ? e.setAuthInfo({
            accessToken: t.accessToken,
            refreshToken: t.refreshToken,
            expiredTime: t.accessTokenExpiredTime,
            openId: t.openId
        }).then(()=>({
            success: !0,
            openId: t.openId,
            authInfo: {
                accessToken: t.accessToken,
                refreshToken: t.refreshToken,
                expiredTime: t.accessTokenExpiredTime
            }
        })) : Promise.resolve({
            success: !1,
            reason: "lwp client is null",
            errorCode: "10001"
        })
    }
    ;
    (at = vt = vt || {})[at.NOT_LOGINED = 0] = "NOT_LOGINED",
    at[at.LOGINED = 1] = "LOGINED",
    vt.NOT_LOGINED;
    var M = new Uint8Array(16);
    var D = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;
    for (var j = [], B = 0; B < 256; ++B)
        j.push((B + 256).toString(16).substr(1));
    function k(t, e) {
        e = 1 < arguments.length && void 0 !== e ? e : 0,
        t = (j[t[e + 0]] + j[t[e + 1]] + j[t[e + 2]] + j[t[e + 3]] + "-" + j[t[e + 4]] + j[t[e + 5]] + "-" + j[t[e + 6]] + j[t[e + 7]] + "-" + j[t[e + 8]] + j[t[e + 9]] + "-" + j[t[e + 10]] + j[t[e + 11]] + j[t[e + 12]] + j[t[e + 13]] + j[t[e + 14]] + j[t[e + 15]]).toLowerCase();
        if ("string" != typeof (e = t) || !D.test(e))
            throw TypeError("Stringified UUID is invalid");
        return t
    }
    function x(t, e, n) {
        var r = (t = t || {}).random || (t.rng || function() {
            if (!b && !(b = "undefined" != typeof crypto && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || "undefined" != typeof msCrypto && "function" == typeof msCrypto.getRandomValues && msCrypto.getRandomValues.bind(msCrypto)))
                throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");
            return b(M)
        }
        )();
        if (r[6] = 15 & r[6] | 64,
        r[8] = 63 & r[8] | 128,
        e) {
            n = n || 0;
            for (var o = 0; o < 16; ++o)
                e[n + o] = r[o];
            return e
        }
        return k(r)
    }
    t(function(t, e) {
        !function() {
            for (var i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", h = new Uint8Array(256), t = 0; t < i.length; t++)
                h[i.charCodeAt(t)] = t;
            e.encode = function(t) {
                for (var e = new Uint8Array(t), n = e.length, r = "", o = 0; o < n; o += 3)
                    r += i[e[o] >> 2],
                    r += i[(3 & e[o]) << 4 | e[o + 1] >> 4],
                    r += i[(15 & e[o + 1]) << 2 | e[o + 2] >> 6],
                    r += i[63 & e[o + 2]];
                return n % 3 == 2 ? r = r.substring(0, r.length - 1) + "=" : n % 3 == 1 && (r = r.substring(0, r.length - 2) + "=="),
                r
            }
            ,
            e.decode = function(t) {
                var e, n, r, o, i = .75 * t.length, s = t.length, a = 0;
                "=" === t[t.length - 1] && (i--,
                "=" === t[t.length - 2] && i--);
                for (var i = new ArrayBuffer(i), c = new Uint8Array(i), u = 0; u < s; u += 4)
                    e = h[t.charCodeAt(u)],
                    n = h[t.charCodeAt(u + 1)],
                    r = h[t.charCodeAt(u + 2)],
                    o = h[t.charCodeAt(u + 3)],
                    c[a++] = e << 2 | n >> 4,
                    c[a++] = (15 & n) << 4 | r >> 2,
                    c[a++] = (3 & r) << 6 | 63 & o;
                return i
            }
        }()
    });
    var F = {
        "-1": "FILE_UNKNOWN",
        0: "IMAGE_JPG",
        1: "IMAGE_GIF",
        2: "IMAGE_PNG",
        3: "IMAGE_BMP",
        4: "AUDIO_AMR",
        5: "AUDIO_MP3",
        6: "VIDEO_MP4",
        7: "AUDIO_WAV",
        8: "NORMAL_FILE",
        9: "OFFICE_DOC",
        10: "OFFICE_DOCX",
        11: "OFFICE_XLS",
        12: "OFFICE_XLSX",
        13: "OFFICE_PPT",
        14: "OFFICE_PPTX",
        15: "NORMAL_ZIP",
        16: "NORMAL_PDF",
        17: "NORMAL_RAR",
        18: "NORMAL_PSD",
        19: "NORMAL_AI",
        20: "NORMAL_TXT",
        21: "VIDEO_AVI",
        22: "VIDEO_RMVB",
        23: "VIDEO_RM",
        24: "VIDEO_MPG",
        25: "VIDEO_WMV",
        26: "VIDEO_MKV",
        27: "VIDEO_VOB",
        28: "NORMAL_TFSPRIVATE",
        29: "IMAGE_WEBP",
        30: "AUDIO_OPUS",
        31: "AUDIO_OGG"
    };
    Object.keys(F).forEach(function(t) {
        F[t].split("_")[1].toLowerCase()
    }),
    t(function(t) {
        function u(t) {
            return t && (t = t.toString().replace(h.pluses, "%20"),
            t = decodeURIComponent(t)),
            t
        }
        function i(t) {
            var e, n, r, o, i, s, a, c = [];
            if (null == t || "" === t)
                return c;
            for (a = (n = (t = (e = 0) === t.indexOf("?") ? t.substring(1) : t).toString().split(h.query_separator)).length; e < a; e++)
                0 !== (o = (r = n[e]).indexOf("=")) && (i = u(r.substring(0, o)),
                s = u(r.substring(o + 1)),
                c.push(-1 === o ? [r, null] : [i, s]));
            return c
        }
        function n(t) {
            var n, r;
            this.uriParts = (t = t,
            n = h.uri_parser.exec(t || ""),
            r = {},
            ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "isColonUri", "relative", "path", "directory", "file", "query", "anchor"].forEach(function(t, e) {
                r[t] = n[e] || ""
            }),
            r),
            this.queryPairs = i(this.uriParts.query),
            this.hasAuthorityPrefixUserPref = null
        }
        var h;
        h = {
            starts_with_slashes: /^\/+/,
            ends_with_slashes: /\/+$/,
            pluses: /\+/g,
            query_separator: /[&;]/,
            uri_parser: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
        },
        Array.prototype.forEach || (Array.prototype.forEach = function(t, e) {
            var n, r;
            if (null == this)
                throw new TypeError(" this is null or not defined");
            var o, i = Object(this), s = i.length >>> 0;
            if ("function" != typeof t)
                throw new TypeError(t + " is not a function");
            for (1 < arguments.length && (n = e),
            r = 0; r < s; )
                r in i && (o = i[r],
                t.call(n, o, r, i)),
                r++
        }
        ),
        ["protocol", "userInfo", "host", "port", "path", "anchor"].forEach(function(e) {
            n.prototype[e] = function(t) {
                return void 0 !== t && (this.uriParts[e] = t),
                this.uriParts[e]
            }
        }),
        n.prototype.hasAuthorityPrefix = function(t) {
            return void 0 !== t && (this.hasAuthorityPrefixUserPref = t),
            null === this.hasAuthorityPrefixUserPref ? -1 !== this.uriParts.source.indexOf("//") : this.hasAuthorityPrefixUserPref
        }
        ,
        n.prototype.isColonUri = function(t) {
            if (void 0 === t)
                return !!this.uriParts.isColonUri;
            this.uriParts.isColonUri = !!t
        }
        ,
        n.prototype.query = function(t) {
            var e, n, r, o = "";
            for (void 0 !== t && (this.queryPairs = i(t)),
            e = 0,
            r = this.queryPairs.length; e < r; e++)
                n = this.queryPairs[e],
                0 < o.length && (o += "&"),
                null === n[1] ? o += n[0] : (o += n[0],
                o += "=",
                void 0 !== n[1] && (o += encodeURIComponent(n[1])));
            return 0 < o.length ? "?" + o : o
        }
        ,
        n.prototype.getQueryParamValue = function(t) {
            for (var e, n = 0, r = this.queryPairs.length; n < r; n++)
                if (t === (e = this.queryPairs[n])[0])
                    return e[1]
        }
        ,
        n.prototype.getQueryParamValues = function(t) {
            for (var e, n = [], r = 0, o = this.queryPairs.length; r < o; r++)
                t === (e = this.queryPairs[r])[0] && n.push(e[1]);
            return n
        }
        ,
        n.prototype.deleteQueryParam = function(t, e) {
            for (var n, r, o, i = [], s = 0, a = this.queryPairs.length; s < a; s++)
                r = u((n = this.queryPairs[s])[0]) === u(t),
                o = n[1] === e,
                (1 !== arguments.length || r) && (2 !== arguments.length || r && o) || i.push(n);
            return this.queryPairs = i,
            this
        }
        ,
        n.prototype.addQueryParam = function(t, e, n) {
            return 3 === arguments.length && -1 !== n ? (n = Math.min(n, this.queryPairs.length),
            this.queryPairs.splice(n, 0, [t, e])) : 0 < arguments.length && this.queryPairs.push([t, e]),
            this
        }
        ,
        n.prototype.hasQueryParam = function(t) {
            for (var e = this.queryPairs.length, n = 0; n < e; n++)
                if (this.queryPairs[n][0] == t)
                    return !0;
            return !1
        }
        ,
        n.prototype.replaceQueryParam = function(t, e, n) {
            var r, o, i = -1, s = this.queryPairs.length;
            if (3 === arguments.length) {
                for (r = 0; r < s; r++)
                    if (u((o = this.queryPairs[r])[0]) === u(t) && decodeURIComponent(o[1]) === u(n)) {
                        i = r;
                        break
                    }
                0 <= i && this.deleteQueryParam(t, u(n)).addQueryParam(t, e, i)
            } else {
                for (r = 0; r < s; r++)
                    if (u((o = this.queryPairs[r])[0]) === u(t)) {
                        i = r;
                        break
                    }
                this.deleteQueryParam(t),
                this.addQueryParam(t, e, i)
            }
            return this
        }
        ,
        ["protocol", "hasAuthorityPrefix", "isColonUri", "userInfo", "host", "port", "path", "query", "anchor"].forEach(function(e) {
            var t = "set" + e.charAt(0).toUpperCase() + e.slice(1);
            n.prototype[t] = function(t) {
                return this[e](t),
                this
            }
        }),
        n.prototype.scheme = function() {
            var t = "";
            return this.protocol() ? (t += this.protocol(),
            this.protocol().indexOf(":") !== this.protocol().length - 1 && (t += ":"),
            t += "//") : this.hasAuthorityPrefix() && this.host() && (t += "//"),
            t
        }
        ,
        n.prototype.origin = function() {
            var t = this.scheme();
            return this.userInfo() && this.host() && (t += this.userInfo(),
            this.userInfo().indexOf("@") !== this.userInfo().length - 1 && (t += "@")),
            this.host() && (t += this.host(),
            (this.port() || this.path() && this.path().substr(0, 1).match(/[0-9]/)) && (t += ":" + this.port())),
            t
        }
        ,
        n.prototype.addTrailingSlash = function() {
            var t = this.path() || "";
            return "/" !== t.substr(-1) && this.path(t + "/"),
            this
        }
        ,
        n.prototype.toString = function() {
            var t, e = this.origin();
            return this.isColonUri() ? this.path() && (e += ":" + this.path()) : this.path() ? (t = this.path(),
            h.ends_with_slashes.test(e) || h.starts_with_slashes.test(t) ? (e && e.replace(h.ends_with_slashes, "/"),
            t = t.replace(h.starts_with_slashes, "/")) : e += "/",
            e += t) : this.host() && (this.query().toString() || this.anchor()) && (e += "/"),
            this.query().toString() && (e += this.query().toString()),
            this.anchor() && (0 !== this.anchor().indexOf("#") && (e += "#"),
            e += this.anchor()),
            e
        }
        ,
        n.prototype.clone = function() {
            return new n(this.toString())
        }
        ,
        t.exports = n
    });
    var H = function(t) {
        t.mediaIdHost && t.mediaIdHost,
        t.authMediaIdHost && t.authMediaIdHost,
        t.authMediaIdCdnHost && t.authMediaIdCdnHost
    }
      , V = Array.isArray
      , G = "object" == typeof c && c && c.Object === Object && c
      , q = "object" == typeof self && self && self.Object === Object && self
      , W = G || q || Function("return this")()
      , g = W.Symbol
      , w = Object.prototype
      , $ = w.hasOwnProperty
      , z = w.toString
      , K = g ? g.toStringTag : void 0;
    var J = function(t) {
        var e = $.call(t, K)
          , n = t[K];
        try {
            var r = !(t[K] = void 0)
        } catch (t) {}
        var o = z.call(t);
        return r && (e ? t[K] = n : delete t[K]),
        o
    }
      , Y = Object.prototype.toString;
    var Q = function(t) {
        return Y.call(t)
    }
      , X = g ? g.toStringTag : void 0;
    var Z = function(t) {
        return null == t ? void 0 === t ? "[object Undefined]" : "[object Null]" : (X && X in Object(t) ? J : Q)(t)
    };
    var tt = function(t) {
        return null != t && "object" == typeof t
    };
    var et = function(t) {
        return "symbol" == typeof t || tt(t) && "[object Symbol]" == Z(t)
    }
      , nt = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/
      , rt = /^\w*$/;
    var ot = function(t, e) {
        if (V(t))
            return !1;
        var n = typeof t;
        return !("number" != n && "symbol" != n && "boolean" != n && null != t && !et(t)) || (rt.test(t) || !nt.test(t) || null != e && t in Object(e))
    };
    var it = function(t) {
        var e = typeof t;
        return null != t && ("object" == e || "function" == e)
    };
    var st = function(t) {
        return !!it(t) && ("[object Function]" == (t = Z(t)) || "[object GeneratorFunction]" == t || "[object AsyncFunction]" == t || "[object Proxy]" == t)
    }
      , at = W["__core-js_shared__"]
      , ct = (vt = /[^.]+$/.exec(at && at.keys && at.keys.IE_PROTO || "")) ? "Symbol(src)_1." + vt : "";
    var ut = function(t) {
        return !!ct && ct in t
    }
      , ht = Function.prototype.toString;
    var ft = function(t) {
        if (null != t) {
            try {
                return ht.call(t)
            } catch (t) {}
            try {
                return t + ""
            } catch (t) {}
        }
        return ""
    }
      , lt = /^\[object .+?Constructor\]$/
      , G = Function.prototype
      , q = Object.prototype
      , w = G.toString
      , at = q.hasOwnProperty
      , dt = RegExp("^" + w.call(at).replace(/[\\^$.*+?()[\]{}|]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$");
    var pt = function(t) {
        return !(!it(t) || ut(t)) && (st(t) ? dt : lt).test(ft(t))
    };
    var gt = function(t, e) {
        return null == t ? void 0 : t[e]
    };
    var vt = function(t, e) {
        return e = gt(t, e),
        pt(e) ? e : void 0
    }
      , yt = vt(Object, "create");
    var G = function(t) {
        return t = this.has(t) && delete this.__data__[t],
        this.size -= t ? 1 : 0,
        t
    }
      , mt = Object.prototype.hasOwnProperty;
    var q = function(t) {
        var e = this.__data__;
        if (yt) {
            var n = e[t];
            return "__lodash_hash_undefined__" === n ? void 0 : n
        }
        return mt.call(e, t) ? e[t] : void 0
    }
      , _t = Object.prototype.hasOwnProperty;
    w = function(t) {
        var e = this.__data__;
        return yt ? void 0 !== e[t] : _t.call(e, t)
    }
    ;
    at = function(t, e) {
        var n = this.__data__;
        return this.size += this.has(t) ? 0 : 1,
        n[t] = yt && void 0 === e ? "__lodash_hash_undefined__" : e,
        this
    }
    ;
    function Et(t) {
        var e = -1
          , n = null == t ? 0 : t.length;
        for (this.clear(); ++e < n; ) {
            var r = t[e];
            this.set(r[0], r[1])
        }
    }
    Et.prototype.clear = function() {
        this.__data__ = yt ? yt(null) : {},
        this.size = 0
    }
    ,
    Et.prototype.delete = G,
    Et.prototype.get = q,
    Et.prototype.has = w,
    Et.prototype.set = at;
    var wt = Et;
    var Ct = function(t, e) {
        return t === e || t != t && e != e
    };
    var Ot = function(t, e) {
        for (var n = t.length; n--; )
            if (Ct(t[n][0], e))
                return n;
        return -1
    }
      , St = Array.prototype.splice;
    G = function(t) {
        var e = this.__data__;
        return !((t = Ot(e, t)) < 0) && (t == e.length - 1 ? e.pop() : St.call(e, t, 1),
        --this.size,
        !0)
    }
    ;
    q = function(t) {
        var e = this.__data__;
        return (t = Ot(e, t)) < 0 ? void 0 : e[t][1]
    }
    ;
    w = function(t) {
        return -1 < Ot(this.__data__, t)
    }
    ;
    at = function(t, e) {
        var n = this.__data__
          , r = Ot(n, t);
        return r < 0 ? (++this.size,
        n.push([t, e])) : n[r][1] = e,
        this
    }
    ;
    function Nt(t) {
        var e = -1
          , n = null == t ? 0 : t.length;
        for (this.clear(); ++e < n; ) {
            var r = t[e];
            this.set(r[0], r[1])
        }
    }
    Nt.prototype.clear = function() {
        this.__data__ = [],
        this.size = 0
    }
    ,
    Nt.prototype.delete = G,
    Nt.prototype.get = q,
    Nt.prototype.has = w,
    Nt.prototype.set = at;
    var bt = Nt
      , Tt = vt(W, "Map");
    var It = function(t) {
        var e = typeof t;
        return "string" == e || "number" == e || "symbol" == e || "boolean" == e ? "__proto__" !== t : null === t
    };
    var Lt = function(t, e) {
        return t = t.__data__,
        It(e) ? t["string" == typeof e ? "string" : "hash"] : t.map
    };
    q = function(t) {
        return t = Lt(this, t).delete(t),
        this.size -= t ? 1 : 0,
        t
    }
    ;
    w = function(t) {
        return Lt(this, t).get(t)
    }
    ;
    at = function(t) {
        return Lt(this, t).has(t)
    }
    ;
    vt = function(t, e) {
        var n = Lt(this, t)
          , r = n.size;
        return n.set(t, e),
        this.size += n.size == r ? 0 : 1,
        this
    }
    ;
    function At(t) {
        var e = -1
          , n = null == t ? 0 : t.length;
        for (this.clear(); ++e < n; ) {
            var r = t[e];
            this.set(r[0], r[1])
        }
    }
    At.prototype.clear = function() {
        this.size = 0,
        this.__data__ = {
            hash: new wt,
            map: new (Tt || bt),
            string: new wt
        }
    }
    ,
    At.prototype.delete = q,
    At.prototype.get = w,
    At.prototype.has = at,
    At.prototype.set = vt;
    var Rt = At
      , Ut = "Expected a function";
    function Pt(r, o) {
        if ("function" != typeof r || null != o && "function" != typeof o)
            throw new TypeError(Ut);
        var i = function() {
            var t = arguments
              , e = o ? o.apply(this, t) : t[0]
              , n = i.cache;
            if (n.has(e))
                return n.get(e);
            t = r.apply(this, t);
            return i.cache = n.set(e, t) || n,
            t
        };
        return i.cache = new (Pt.Cache || Rt),
        i
    }
    Pt.Cache = Rt;
    var Mt = Pt;
    var Dt = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g
      , jt = /\\(\\)?/g
      , Bt = function(t) {
        var e = (t = Mt(t, function(t) {
            return 500 === e.size && e.clear(),
            t
        })).cache;
        return t
    }(function(t) {
        var o = [];
        return 46 === t.charCodeAt(0) && o.push(""),
        t.replace(Dt, function(t, e, n, r) {
            o.push(n ? r.replace(jt, "$1") : e || t)
        }),
        o
    });
    var kt = function(t, e) {
        for (var n = -1, r = null == t ? 0 : t.length, o = Array(r); ++n < r; )
            o[n] = e(t[n], n, t);
        return o
    }
      , xt = 1 / 0
      , vt = g ? g.prototype : void 0
      , Ft = vt ? vt.toString : void 0;
    var Ht = function t(e) {
        if ("string" == typeof e)
            return e;
        if (V(e))
            return kt(e, t) + "";
        if (et(e))
            return Ft ? Ft.call(e) : "";
        var n = e + "";
        return "0" == n && 1 / e == -xt ? "-0" : n
    };
    var Vt = function(t) {
        return null == t ? "" : Ht(t)
    };
    var Gt = function(t, e) {
        return V(t) ? t : ot(t, e) ? [t] : Bt(Vt(t))
    };
    var qt = function(t) {
        if ("string" == typeof t || et(t))
            return t;
        var e = t + "";
        return "0" == e && 1 / t == -1 / 0 ? "-0" : e
    };
    var Wt = function(t, e) {
        for (var n = 0, r = (e = Gt(e, t)).length; null != t && n < r; )
            t = t[qt(e[n++])];
        return n && n == r ? t : void 0
    };
    var $t = function(t, e, n) {
        return void 0 === (e = null == t ? void 0 : Wt(t, e)) ? n : e
    };
    (class extends Error {
    }
    );
    const zt = [{
        property: "name",
        enumerable: !1
    }, {
        property: "message",
        enumerable: !1
    }, {
        property: "stack",
        enumerable: !1
    }, {
        property: "code",
        enumerable: !0
    }]
      , Kt = ({from: t, seen: e, to_: n, forceEnumerable: r})=>{
        const o = n || (Array.isArray(t) ? [] : {});
        e.push(t);
        for (var [i,s] of Object.entries(t))
            "function" != typeof s && (s && "object" == typeof s ? e.includes(t[i]) ? o[i] = "[Circular]" : o[i] = Kt({
                from: t[i],
                seen: e.slice(),
                forceEnumerable: r
            }) : o[i] = s);
        for (var {property: a, enumerable: c} of zt)
            "string" == typeof t[a] && Object.defineProperty(o, a, {
                value: t[a],
                enumerable: !!r || c,
                configurable: !0,
                writable: !0
            });
        return o
    }
    ;
    var Jt = t=>"object" == typeof t && null !== t ? Kt({
        from: t,
        seen: [],
        forceEnumerable: !0
    }) : "function" == typeof t ? `[Function: ${t.name || "anonymous"}]` : t
      , Yt = function() {
        return W.Date.now()
    }
      , Qt = /\s/;
    var Xt = function(t) {
        for (var e = t.length; e-- && Qt.test(t.charAt(e)); )
            ;
        return e
    }
      , Zt = /^\s+/;
    var te = function(t) {
        return t && t.slice(0, Xt(t) + 1).replace(Zt, "")
    }
      , ee = /^[-+]0x[0-9a-f]+$/i
      , ne = /^0b[01]+$/i
      , re = /^0o[0-7]+$/i
      , oe = parseInt;
    var ie = function(t) {
        if ("number" == typeof t)
            return t;
        if (et(t))
            return NaN;
        if (it(t) && (e = "function" == typeof t.valueOf ? t.valueOf() : t,
        t = it(e) ? e + "" : e),
        "string" != typeof t)
            return 0 === t ? t : +t;
        t = te(t);
        var e = ne.test(t);
        return e || re.test(t) ? oe(t.slice(2), e ? 2 : 8) : ee.test(t) ? NaN : +t
    }
      , se = Math.max
      , ae = Math.min;
    var ce, ue, he, fe = function(r, n, t) {
        var o, i, s, a, c, u, h = 0, f = !1, l = !1, e = !0;
        if ("function" != typeof r)
            throw new TypeError("Expected a function");
        function d(t) {
            var e = o
              , n = i;
            return o = i = void 0,
            h = t,
            a = r.apply(n, e)
        }
        function p(t) {
            var e = t - u;
            return void 0 === u || n <= e || e < 0 || l && s <= t - h
        }
        function g() {
            var t, e = Yt();
            if (p(e))
                return v(e);
            c = setTimeout(g, (e = n - ((t = e) - u),
            l ? ae(e, s - (t - h)) : e))
        }
        function v(t) {
            return c = void 0,
            e && o ? d(t) : (o = i = void 0,
            a)
        }
        function y() {
            var t = Yt()
              , e = p(t);
            if (o = arguments,
            i = this,
            u = t,
            e) {
                if (void 0 === c)
                    return h = e = u,
                    c = setTimeout(g, n),
                    f ? d(e) : a;
                if (l)
                    return clearTimeout(c),
                    c = setTimeout(g, n),
                    d(u)
            }
            return void 0 === c && (c = setTimeout(g, n)),
            a
        }
        return n = ie(n) || 0,
        it(t) && (f = !!t.leading,
        l = "maxWait"in t,
        s = l ? se(ie(t.maxWait) || 0, n) : s,
        e = "trailing"in t ? !!t.trailing : e),
        y.cancel = function() {
            void 0 !== c && clearTimeout(c),
            o = u = i = c = void (h = 0)
        }
        ,
        y.flush = function() {
            return void 0 === c ? a : v(Yt())
        }
        ,
        y
    };
    (g = ce = ce || {})[g.ENV_ONLINE = 0] = "ENV_ONLINE",
    g[g.ENV_PRERELEASE = 1] = "ENV_PRERELEASE",
    g[g.ENV_DAILY = 2] = "ENV_DAILY",
    g[g.ENV_MOCK = 3] = "ENV_MOCK";
    class le {
        constructor() {
            this.setting = {
                environment: ce.ENV_ONLINE,
                appKey: "",
                mediaHost: "https://static.dingtalk.com/media",
                deviceId: "",
                appLocale: "zh_CN",
                deviceLocale: "zh_CN",
                timeZone: "Asia/Shanghai",
                debug: !1,
                log: {
                    error(...t) {
                        console.error(...t)
                    },
                    info(...t) {
                        console.info(...t)
                    }
                },
                authTokenCallback: ()=>Promise.resolve({})
            }
        }
        static getInstance() {
            return this.instance || (this.instance = new le),
            this.instance
        }
        set(t) {
            if (be.getCloudVersion() && !t.wsUrl)
                throw new Error(" ");
            this.setting = Object.assign(Object.assign({}, this.setting), t)
        }
        get() {
            return this.setting
        }
    }
    function de(t, s, a, c) {
        return new (a = a || Promise)(function(n, e) {
            function r(t) {
                try {
                    i(c.next(t))
                } catch (t) {
                    e(t)
                }
            }
            function o(t) {
                try {
                    i(c.throw(t))
                } catch (t) {
                    e(t)
                }
            }
            function i(t) {
                var e;
                t.done ? n(t.value) : ((e = t.value)instanceof a ? e : new a(function(t) {
                    t(e)
                }
                )).then(r, o)
            }
            i((c = c.apply(t, s || [])).next())
        }
        )
    }
    let pe;
    const ge = (t,e,n)=>{
        if (pe && pe.sendMsg)
            return pe.sendMsg(t, e, n);
        throw new Error("rpc is null, must init rpc first")
    }
    ;
    i.ConnectionStatus = void 0,
    (vt = i.ConnectionStatus || (i.ConnectionStatus = {}))[vt.CONN_UNCONNECTED = 0] = "CONN_UNCONNECTED",
    vt[vt.CONN_CONNECTING = 1] = "CONN_CONNECTING",
    vt[vt.CONN_CONNECTED = 2] = "CONN_CONNECTED",
    vt[vt.CONN_AUTHING = 3] = "CONN_AUTHING",
    vt[vt.CONN_AUTHED = 4] = "CONN_AUTHED",
    vt[vt.CONN_ERROR = 5] = "CONN_ERROR";
    const ve = {
        [ce.ENV_ONLINE]: "wss://wss-cntaobao.dingtalk.com",
        [ce.ENV_DAILY]: "wss://tls-impaas-daily.dingtalk.com:7003",
        [ce.ENV_PRERELEASE]: "wss://pre-wss-cntaobao.dingtalk.com",
        [ce.ENV_MOCK]: "wss://webalfa-cm3.dingtalk.com/long"
    }
      , ye = {
        [ce.ENV_DAILY]: "lws-short-daily-impaas.dingtalk.com",
        [ce.ENV_ONLINE]: "impaas-static.dingtalk.com",
        [ce.ENV_PRERELEASE]: "pre-down-impaas.dingtalk.com"
    };
    class me {
        constructor() {
            this.innerConnectionStatus = i.ConnectionStatus.CONN_UNCONNECTED,
            this.lwpClient = null,
            this.domain = ""
        }
        static getInstance() {
            return this.instance || (this.instance = new me),
            this.instance
        }
        get ConnectionStatus() {
            return this.innerConnectionStatus
        }
        set ConnectionStatus(t) {
            this.innerConnectionStatus = t,
            be.getEventService().emit(i.EventNameEnum.PaaSConnectionChanged, t)
        }
        isNetworkAvailable() {
            return !0
        }
        getConnectionStatus() {
            return this.ConnectionStatus
        }
        login() {
            return de(this, void 0, void 0, function*() {
                var t = function(t, e) {
                    var n = {};
                    for (o in t)
                        Object.prototype.hasOwnProperty.call(t, o) && e.indexOf(o) < 0 && (n[o] = t[o]);
                    if (null != t && "function" == typeof Object.getOwnPropertySymbols)
                        for (var r = 0, o = Object.getOwnPropertySymbols(t); r < o.length; r++)
                            e.indexOf(o[r]) < 0 && Object.prototype.propertyIsEnumerable.call(t, o[r]) && (n[o[r]] = t[o[r]]);
                    return n
                }(be.getSettingService().get(), ["debug"]);
                let r = 0
                  , o = !0;
                var e = ye[t.environment] || ye[ce.ENV_PRERELEASE];
                if (H({
                    mediaIdHost: e,
                    authMediaIdHost: e
                }),
                this.lwpClient)
                    return A(),
                    void (this.ConnectionStatus = i.ConnectionStatus.CONN_CONNECTED);
                this.ConnectionStatus = i.ConnectionStatus.CONN_CONNECTING;
                const n = {
                    appKey: t.appKey,
                    wsUrl: t.wsUrl || ve[t.environment],
                    ua: window.navigator.userAgent,
                    deviceId: t.deviceId,
                    lwpHeadersConfig: {
                        wv: "im:3,au:3,sy:6"
                    },
                    log: t.log,
                    disableWsAuthConnect: !0,
                    paasProject: !0
                };
                t.subscribeServerPush && n.lwpHeadersConfig && (n.lwpHeadersConfig["subscribe-server-push"] = t.subscribeServerPush),
                this.ConnectionStatus = i.ConnectionStatus.CONN_AUTHING,
                ((t,e)=>{
                    if (L)
                        throw new Error("Cannot init lwp client more than once");
                    L = new T(t,e)
                }
                )(t.appName || "browser demo", n),
                A(),
                this.lwpClient = L,
                this.lwpClient && (this.ConnectionStatus = i.ConnectionStatus.CONN_CONNECTED,
                this.lwpClient.addListener(T.EventsName.AuthStateChange, n=>de(this, void 0, void 0, function*() {
                    var t;
                    switch (n) {
                    case p.INITED:
                    case p.REFRESH_TOKEN:
                        this.ConnectionStatus = i.ConnectionStatus.CONN_UNCONNECTED;
                        break;
                    case p.SUBSCRIBE_FAILED:
                        if (r < 4 && o) {
                            r++,
                            this.ConnectionStatus = i.ConnectionStatus.CONN_AUTHING;
                            try {
                                const n = yield be.getSettingService().get().authTokenCallback();
                                try {
                                    if (be.getCloudVersion()) {
                                        const t = $t(n, "uid", 0);
                                        t && (n.openId = t)
                                    }
                                    if (!n.accessToken)
                                        return void be.getLoggerService().error(i.LocalLogType.ERROR, "authTokenCallback catch", n);
                                    yield P(n),
                                    this.myUid = n.openId ? n.openId + "" : void 0,
                                    r = 0;
                                    const e = null === (t = $t(this.lwpClient, "getPaasDomain", null)) || void 0 === t ? void 0 : t.bind(this.lwpClient);
                                    e && (this.domain = e() || "")
                                } catch (t) {
                                    o = !(!t.body || "4000001" !== t.body.code || 401 !== t.code),
                                    be.getLoggerService().error(i.LocalLogType.ERROR, "PaaS login catch", t)
                                }
                            } catch (t) {
                                be.getLoggerService().error(i.LocalLogType.ERROR, "authTokenCallback catch", t),
                                this.ConnectionStatus = i.ConnectionStatus.CONN_ERROR
                            }
                        } else
                            this.ConnectionStatus = i.ConnectionStatus.CONN_ERROR,
                            be.getLoggerService().error(i.LocalLogType.ERROR, "PaaS login error");
                        break;
                    case p.SUBSCRIBED:
                        this.ConnectionStatus = i.ConnectionStatus.CONN_AUTHED
                    }
                })),
                be.getEventService().registerSyncPushHandler(this.lwpClient),
                pe = {
                    sendMsg: (r,t,e)=>de(this, void 0, void 0, function*() {
                        if (this.lwpClient) {
                            const n = Date.now();
                            return this.lwpClient.sendMsg(r, t, e).catch(t=>{
                                var e = Date.now() - n;
                                return be.getLoggerService().error(i.LocalLogType.ERROR, `[rpc] catch ${e}ms`, r, t),
                                Promise.reject(t)
                            }
                            )
                        }
                        return Promise.reject("lwpClient is null")
                    })
                })
            })
        }
        logout() {
            return this.lwpClient && (this.lwpClient.clearAuthInfo(),
            this.ConnectionStatus = i.ConnectionStatus.CONN_UNCONNECTED),
            Promise.resolve()
        }
        kickout() {
            return Promise.resolve()
        }
        getMyOpenId() {
            return this.myUid
        }
        getDeviceId() {
            return de(this, void 0, void 0, function*() {
                var t = "interaction_paas_did"
                  , e = "interaction_paas_tab_id";
                let n = be.getStorageService().get(t, !0)
                  , r = sessionStorage.getItem(e);
                return (!n || 0 < n.indexOf("-")) && (n = x().replace(/-/g, ""),
                be.getStorageService().set(t, n, !0)),
                r || (r = Date.now() + "",
                sessionStorage.setItem(e, r)),
                `${n}-${r}`
            })
        }
        getDomain() {
            return this.domain
        }
    }
    class _e {
        constructor() {}
        static getInstance() {
            return this.instance || (this.instance = new _e),
            this.instance
        }
        succes(t, e, n) {}
        fail(t, e, n, r, o) {}
        count(t, e, n, r) {}
    }
    class Ee {
        constructor(t, e) {
            this.syncHandlers = {},
            this.topicName = t,
            e && Object.keys(e).forEach(t=>{
                this.registerHandler(parseInt(t, 10), e[t])
            }
            ),
            this.handlePush = this.handlePush.bind(this)
        }
        registerHandler(t, e) {
            this.syncHandlers[t + ""] = e
        }
        unRegisterHandler(t) {
            delete this.syncHandlers[t + ""]
        }
        handlePush(n) {
            var r;
            return de(this, void 0, void 0, function*() {
                const e = n.body;
                return 1 === (null === (r = null == e ? void 0 : e.syncExtraType) || void 0 === r ? void 0 : r.type) || 2 === (null === (r = null == e ? void 0 : e.syncExtraType) || void 0 === r ? void 0 : r.type) ? (t = {},
                ge("/r/SyncStatus/getState", t, [{
                    topic: "sync"
                }]).then(t=>200 === t.code && t.body ? ((t,e={})=>ge("/r/SyncStatus/ackDiff", e, [t]))(t.body) : Promise.reject(t)).catch(t=>{
                    be.getLoggerService().error("error at sync isToolong2", t)
                }
                )) : setTimeout(()=>{
                    var t;
                    ((null === (t = e.syncPushPackage) || void 0 === t ? void 0 : t.data) || []).forEach((t={})=>{
                        const {bizType: e, data: n, objectType: r} = t;
                        if (n && r && e)
                            try {
                                const t = "string" == typeof n ? Ee.decodeJsonFromBase64(n) : n
                                  , e = this.syncHandlers[r + ""];
                                e && e(t)
                            } catch (t) {
                                be.getLoggerService().error(`error at decode64 ${r}`, t)
                            }
                    }
                    )
                }
                , 0),
                {
                    code: 200,
                    headers: {},
                    body: {}
                };
                var t
            })
        }
        static decodeJsonFromBase64(t) {
            return JSON.parse(decodeURIComponent(Array.prototype.map.call(atob(t), function(t) {
                return "%" + ("00" + t.charCodeAt(0).toString(16)).slice(-2)
            }).join("")))
        }
    }
    i.EventNameEnum = void 0,
    Object.freeze({
        __proto__: null,
        SyncPushHandler: Ee
    }),
    (g = i.EventNameEnum || (i.EventNameEnum = {})).PaaSConnectionChanged = "paas.connection.changed",
    g.PaaSLiveRoomEnter = "paas.live.room.enter",
    g.PaaSLiveRoomOlineCount = "paas.live.room.onlinecount",
    g.PaaSLiveRoomNotice = "paas.live.room.notice",
    g.PaaSLiveRoomComment = "paas.live.room.comment",
    g.PaaSLiveRoomLike = "paas.live.room.like",
    g.PaaSLiveRoomCustomMessage = "paas.live.room.customMessage",
    (vt = ue = ue || {})[vt.ROOM_ONLINE_COUNT_SUBTYPE = 1001] = "ROOM_ONLINE_COUNT_SUBTYPE",
    vt[vt.ROOM_NOTICE_SUBTYPE = 1002] = "ROOM_NOTICE_SUBTYPE",
    vt[vt.ROOM_NORMAL_COMMENT = 1201] = "ROOM_NORMAL_COMMENT",
    vt[vt.ROOM_LIKE_COUNT = 1301] = "ROOM_LIKE_COUNT",
    vt[vt.ROOM_CUSTOM_MESSAGE = 100001] = "ROOM_CUSTOM_MESSAGE";
    const we = Object.values(i.EventNameEnum);
    class Ce {
        constructor() {
            this.emitter = new e.EventEmitter
        }
        static getInstance() {
            return this.instance || (this.instance = new Ce),
            this.instance
        }
        register(e) {
            return we.forEach(t=>{
                this.emitter.addListener(t, e)
            }
            ),
            ()=>{
                we.forEach(t=>{
                    this.emitter.removeListener(t, e)
                }
                )
            }
        }
        unRegister() {
            this.emitter.removeAllListeners()
        }
        emit(t, ...e) {
            return this.emitter.emit(t, t, ...e)
        }
        registerSyncPushHandler(t) {
            var e = new Ee("/s/para",{
                1e4: t=>{
                    try {
                        Ce.subTypeEventsHandler(t)
                    } catch (t) {
                        be.getLoggerService().error("error at pushHandler decode 10000", t)
                    }
                    return Promise.resolve()
                }
            });
            t.registerPushHandler(e.topicName, e.handlePush)
        }
        static subTypeEventsHandler(t) {
            try {
                var {subType: e, body: n} = "object" == typeof t && 0 < t.length ? t[0] : t
                  , r = "string" == typeof n ? JSON.parse(n) : n;
                switch (e) {
                case ue.ROOM_ONLINE_COUNT_SUBTYPE:
                    be.getEventService().emit(i.EventNameEnum.PaaSLiveRoomOlineCount, r);
                    break;
                case ue.ROOM_NORMAL_COMMENT:
                    be.getEventService().emit(i.EventNameEnum.PaaSLiveRoomComment, r);
                    break;
                case ue.ROOM_NOTICE_SUBTYPE:
                    be.getEventService().emit(i.EventNameEnum.PaaSLiveRoomNotice, r);
                    break;
                case ue.ROOM_LIKE_COUNT:
                    be.getEventService().emit(i.EventNameEnum.PaaSLiveRoomLike, r);
                    break;
                case ue.ROOM_CUSTOM_MESSAGE:
                    be.getEventService().emit(i.EventNameEnum.PaaSLiveRoomCustomMessage, r)
                }
            } catch (t) {
                be.getLoggerService().error("error at subTypeEventsHandler of objectType 10000", t)
            }
        }
    }
    i.LocalLogType = void 0,
    (g = he = he || {}).draft = "im_paas_sdk_conv_draft",
    g.localLog = "im_paas_sdk_localLog";
    class Oe {
        constructor() {}
        static getInstance() {
            return this.instance || (this.instance = new Oe),
            this.instance
        }
        get(t, e) {
            try {
                var n = be.getAuthService().getMyOpenId()
                  , r = e ? t : `${t}_${n}`;
                return localStorage.getItem(r) || ""
            } catch (t) {
                return ""
            }
        }
        set(t, e, n) {
            try {
                var r = be.getAuthService().getMyOpenId()
                  , o = n ? t : `${t}_${r}`;
                return localStorage.setItem(o, e),
                !0
            } catch (t) {
                return !1
            }
        }
    }
    (vt = i.LocalLogType || (i.LocalLogType = {})).INFO = "INFO",
    vt.ERROR = "ERROR";
    class Se {
        constructor() {
            this.batchSyncLocallogToStorage = fe(this.batchSyncLocallogToStorage, 300)
        }
        static getInstance() {
            return this.instance || (this.instance = new Se),
            this.instance
        }
        batchSyncLocallogToStorage() {}
        info(...t) {
            this.logFn || (this.logFn = be.getSettingService().get().log),
            this.logFn.info(...t),
            this.localLog(i.LocalLogType.INFO, ...t)
        }
        error(...t) {
            this.logFn || (this.logFn = be.getSettingService().get().log),
            this.logFn.error(...t),
            this.localLog(i.LocalLogType.ERROR, ...t)
        }
        localLog(t, ...e) {
            if (be.getAuthService().getMyOpenId()) {
                if (void 0 === this.localLogData) {
                    try {
                        this.localLogData = JSON.parse(be.getStorageService().get(he.localLog))
                    } catch (t) {}
                    this.localLogData = this.localLogData || []
                }
                const n = [`[${t}] ${(new Date).toLocaleString()}`];
                e.forEach(t=>{
                    t.constructor === Error ? n.push(JSON.stringify(Jt(t))) : n.push(JSON.stringify(t))
                }
                ),
                this.localLogData.push(n.join(". ")),
                this.batchSyncLocallogToStorage()
            }
        }
    }
    class Ne {
        constructor() {}
        static getInstance() {
            return this.instance || (this.instance = new Ne),
            this.instance
        }
        enterRoom(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/Room/enterRoom", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [enterRoom]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        leaveRoom(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/Room/leaveRoom", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [leaveRoom]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        sendCustomMsg(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/RoomMessage/sendCustomMsg", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [sendCustomMsg]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        sendCommentMsg(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/RoomMessage/sendCommentMsg", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [sendCommentMsg]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        sendLikesMsg(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/RoomMessage/sendLikesMsg", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [sendLikesMsg]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        queryMsg(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/RoomMessage/queryMsg", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [queryMsg]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        publishRoomNotice(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/Room/publishRoomNotice", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [publishRoomNotice]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
        getRoomDetail(n) {
            return de(this, void 0, void 0, function*() {
                var t, e, t = (t = n,
                e = {},
                yield ge("/r/Adaptor/Room/getRoomDetail", e, [t]));
                if (200 === t.code)
                    return t.body;
                {
                    const n = "response error at [getRoomDetail]";
                    throw be.getLoggerService().error(n, t),
                    n
                }
            })
        }
    }
    g = (Number.MAX_SAFE_INTEGER || "9007199254740991") + "",
    vt = Object.freeze({
        __proto__: null,
        MAX_SAFE_NUMBER: g
    });
    (g = {})[g.deleted = 0] = "deleted",
    g[g.normal = 1] = "normal",
    g[g.recall = 2] = "recall",
    g[g.deletedOfReceiver = 3] = "deletedOfReceiver",
    g[g.degradation = 4] = "degradation",
    (g = {})[g.sender = 0] = "sender",
    g[g.groupOwner = 1] = "groupOwner",
    g[g.system = 2] = "system",
    g[g.safety = 3] = "safety",
    (g = {})[g.TooLong = 1] = "TooLong",
    g[g.TooLong2 = 2] = "TooLong2";
    const be = class t {
        constructor() {
            this.isCloud = !1
        }
        static getInstance() {
            return this.instance || (this.instance = new t),
            this.instance
        }
        setCloudVersion() {
            this.isCloud = !0
        }
        getCloudVersion() {
            return this.isCloud
        }
        getSettingService() {
            return le.getInstance()
        }
        getAuthService() {
            return me.getInstance()
        }
        getInteractionService() {
            return Ne.getInstance()
        }
        getUtService() {
            return _e.getInstance()
        }
        getEventService() {
            return Ce.getInstance()
        }
        getLoggerService() {
            return Se.getInstance()
        }
        getStorageService() {
            return Oe.getInstance()
        }
    }
    .getInstance();
    be.setCloudVersion(),
    i.constants = vt,
    i.interactionSdk = be,
    Object.defineProperty(i, "__esModule", {
        value: !0
    })
}(this.DLiveInteraction = this.DLiveInteraction || {});
